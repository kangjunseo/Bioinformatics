# Implement GibbsSampler
## Problem
We have previously defined the notion of a Profile-most probable k-mer in a string. We now define a Profile-randomly generated k-mer in a string Text. For each k-mer Pattern in Text, compute the probability Pr(Pattern | Profile), resulting in n = |Text| - k + 1 probabilities (p1, …, pn). These probabilities do not necessarily sum to 1, but we can still form the random number generator Random(p1, …, pn) based on them. GIBBSSAMPLER uses this random number generator to select a Profile-randomly generated k-mer at each step: if the die rolls the number i, then we define the Profile-randomly generated k-mer as the i-th k-mer in Text.

    GIBBSSAMPLER(Dna, k, t, N)
        randomly select k-mers Motifs = (Motif1, …, Motift) in each string
            from Dna
        BestMotifs ← Motifs
        for j ← 1 to N
            i ← Random(t)
            Profile ← profile matrix constructed from all strings in Motifs
                       except for Motifi
            Motifi ← Profile-randomly generated k-mer in the i-th sequence
            if Score(Motifs) < Score(BestMotifs)
                BestMotifs ← Motifs
        return BestMotifs
Implement GibbsSampler
Given: Integers k, t, and N, followed by a collection of strings Dna.

Return: The strings BestMotifs resulting from running GibbsSampler(Dna, k, t, N) with 20 random starts. Remember to use pseudocounts!


```python
import random

def MakeProfile(motifs):
    code_dict = {'A':0,'C':1,'G':2,'T':3}
    prof = [[1 for col in range(4)] for row in range(len(motifs[0]))]
    L = len(motifs)
    for motif in motifs:
        for idx, i in enumerate(motif):
            prof[idx][code_dict[i]]+=1
    
    for i in range(len(prof)):
        for j in range(len(prof[0])):
            prof[i][j]/=(L+4)
            
    return prof

def ProfileMostProbable(Text, k, Profile):
    max_score = -1
    target = ''
    code_dict = {'A':0, 'C':1, 'G':2, 'T':3}
    for i in range(len(Text)-k+1):
        score = 1
        for j, base in enumerate(Text[i:i+k]):
            score*=float(Profile[j][code_dict[base]])
        
        if score>max_score:
            max_score = score
            target = Text[i:i+k]
            
    return target

def ProfileRandomGenerator(Text, k, Profile):
    scores = []
    code_dict = {'A':0, 'C':1, 'G':2, 'T':3}
    for i in range(len(Text)-k+1):
        score = 1
        for j, base in enumerate(Text[i:i+k]):
            score*=float(Profile[j][code_dict[base]])
        scores.append(score)
    
    target_idx = random.choices(range(len(Text)-k+1),weights=scores)[0]
        
    return Text[target_idx:target_idx+k]

def score(motifs):
    score = 0
    for i in range(len(motifs[0])):
        j = [motif[i] for motif in motifs]
        score += (len(j) - max(j.count("A"), j.count("C"), j.count("T"), j.count("G")))
    return score
        
def GibbsSampler(Dna, k, t, N):
    Motifs = []
    Best = []
    for i in Dna:
        rand_idx = random.randrange(len(Dna[0])-k+1)
        Motifs.append(i[rand_idx:rand_idx+k])
    Best = Motifs
    
    for j in range(N):
        rand_idx = random.randrange(t)
        Profile = MakeProfile(Motifs[:rand_idx]+Motifs[rand_idx+1:])
        Motifs[rand_idx] = ProfileRandomGenerator(Dna[rand_idx],k,Profile)
        
        if score(Motifs) < score(Best): Best = Motifs
    
    return Best, score(Best)
    
```


```python
I = input().split()
k, t, N = int(I[0]), int(I[1]), int(I[2])
Dna = I[3:]

answer = None
min_loss = 1e9

for i in range(20):
    temp, loss = GibbsSampler(Dna, k, t, N)
    if(loss < min_loss):
        min_loss = loss
        answer = temp

for i in answer:
    print(i)
print(min_loss)
```

    15 20 2000 GCGGACCTCACAGGCAGACTCCATCGAAGAACCGGCGTATAGTTGAGTTTATTATGCAAAGAACGCCAAGATAATCTTGCAAACACGCTAAGAGTCGCTAGGCCAATCTATAAGGGTAGTGTTACACGCTGCTAGTAGCGTGGGTGTCAAATACTGACCCCTAATAGGGAGCTCTGACCTGGTGCCCGGAATTGCCTCTGATGCCGTTAGAAATCTACCTGGGCGAATCTGGTTTGTGGGCCCGCAGAGGAACAGCTAGATCACCAAGCAAACACACACACCCTTTGATCCGTTTCGCCCATGAAATCCTGGAGCGAGCGGACCTCACAGGC AGACTCCATCGAAGAACCGGCGTATAGTTGAGTTTATTATGCAAAGAACGCCAAGATAATCTTGCAAACACGCTAAGAGTCGCTAGGCCAATCTATAAGGGTAGTGTTACACGCTGCTAGTAGCGTGGGTGTCAAATACTGACCCCTAATAGGGAGCTCTGACCTGGTGCCCGGAATTGCCCATACGCTACACGCCTCTGATGCCGTTAGAAATCTACCTGGGCGAATCTGGTTTGTGGGCCCGCAGAGGAACAGCTAGATCACCAAGCAAACACACACACCCTTTGATCCGTTTCGCCCATGAAATCCTGGAGCGAGCGGACCTCACAGGC TAGGTTTTAATGACACCTAGTGGGCGGCACAAATCTTCCAGCTCTCGTTCTAGACCCCTGCCGACTCCCGCTCGCACTCATGGCATGCTTACATGAATTTGAGTATTTCCTACCTGTCTGGGCGAATTAACCTAAAGGGGTTTTAGTTCCTGAGGCTACACGCTGAGTTCTATCATAACATGGATTGGCTGCAGATTGTCGACCTCCAAGTCATCCTTACCACTATCATCGTGGCAGTCCTCTTTCGCACTCCGTTTTCGGTCCCAAGCTGCCTGACACCCCTAGGTCTATTTTTCATTAATCAGTTACTCGCGGCCTGATCTATCAGTATG TCTGCAAGGCGCTTATCCTACTGGTTCCGTCCATTGGTATGCGCCAGACGAGAGTGTCAGTTACTTTGAACCCAGGGCAGTACTCGGGCAGAAAGCTTCCGATGACTTGTGTTATCGCTCTTTATGCGGACGGAATCCAGATCCATTTGCTCTGGAACTTTGGTAGAGCCCACTTGGACAGGTCGTATGGTTTGCCCCCCAAATTTAGGGAAGTGACAGAGGCATGGACAACCTCGGCATGTGTAGAGTTCCAAGGGGGGCACGCTGCGTGACGAGATGGAATGAGCCATTCCGGGTCATGGGTAAGTAAGCTTGAGCTCTTCGTGCCGTAT CCACGAGCGCCAAGGGCTCTCCGCAACTAACGAGGACTCTGGGACTATCGAGGAGTTTATAAGGTGCCGTCGGAGTCGGAACATGCCGCACTAATCTTGTCCCAGTGGCTCATGGCACCTAATTCCGCCAAGATTAAATATTTGCACAGGACAGCTAGCAAAAGCGATTCCGTCTTAATATGCTGCAACGGCGGTAGAAGTCGATTAGGAGCGCCAGTCGGTTTAGTTACTGAATATCTTTACAGAATCGGGGTAAAACGTGTAGGTCAGGTTTAAATATTGTTGATACGTATGCCAAGGCGAGTATGACCGACTAGACCCGTCGACGCAAG GACCACGTCGCTCGGCTTGTTTCCCGTTGTAATAGTTTTAATAAAGCTCAATCTTTAGTCTGAGCCACTCGGACGTATGAAGCCAAGGGCTATCAGCCCTCTTTGATTGGAGCAGCCCCATCCACTACATAGGCACCGGAGTTTTATGACGGTAACCTTCCCTCATACCCTAAACCCGCCGTTTTGGGAGAACGAGGGCTTTCATGCGTTAGAGACGATTCGGGTAGCGTAGTGAGAGCGGTAAAGACTCAAGGGTCTCGTTTAATCGCGGCATCCATCAACGTGGTGGTCACACGAGGCGTGTGCTGAGACTGGCCGGTGCCCAGCTTGCC CGTAATCAAAATTAACGCCCAACAGTTATCCTAGCTACTCTCATCCCTACTATAAGTAAAAATCCATGCCCTGGCTGAATTCCGTTCACCCCAAGGTGGACACGCCACTTTTTGCCAGGAGGCCTCAAGCCACTCGCCATGAAACCTCTACACGGATTTTCGTAGAGTGATTATTCGGTCAAGGGCCAAGACGGCGATAGGGCCTAGTAGTTTGCCTCCAGGCACACCCGATAGGTATGCCACTGAGGTGCAACTACACACGGTTTTATTTGGCGAGCAGAGAGGTACAAAAAGTGAGGTAAAGCAGATAATGGGATAACCCGCTGTTGGAC ACCCCGCTCCCTTCCAAGCCAGTGCGAGCTGTGAGTCACGCTTAAGCCGCAAGTGTTACGGTAGTCATAAACGACCTTGCGTATAAGCGACGTCCACATCAGACTCCGGACCGCCTATCTTCTACACGGTTACGACTACCGCATTAACGTGAGTATAGGGCTACACGCTTGTACGGTGCATATTCAACACGAAGTAGCGGCCTGTCTCCCCCTTGTCCCCTCCGCTAGTGCGGCACCTACTTATTGCTTAGACGGTCACGAGAATTGCATGTGCGGGTCACTTGGCTCCCCTGTGAGTTCAGGATTGCGGTTCGTACATTAATTTCCAACGA TCGAATGATAGAGTTAGAAGAGATGTCCGATTCCAGTCGGATACTACTTAAGCGGGTGCCGCCTCTTTGGTCTGCAAGGGCTACACCTCACGTGGGGGCAGAGCTATCCTCACTATCGAATCGAGATGTTAGTCTGGTCCCCCCAAAGGATGTGCCTACTCCTCTGTCCTTGACGCATTTCCCGCGACCCTAGCGTGACACGGTCATACGGACCCTAAGCTACTAACAGGACGTTGTAGCAAGTATACTCACCGAGGTGAAGAGGACTTGTACCTATAAAAAACCTTCGGGGTTTGGGATACTCGCTCACCTCCCGCTCGAATGTGGGCCGT ACTGCCGAGACCAAATCGCCAACCAACCTCCTAGCCTGGTTAACACGCATGTAACTCGAACAGCGTTCGTGTGATCATCCAAGTTGCAGCCTAAACCCCTAGAGCCAAGACGTACACGCGAATTGAACTAAGATCCACAGGGCACTCACCCCGTGGAAAATATAATTCCATGCTCCTCGTTAAGGTGCTTAACTGCATGAACAGAAGGCGACTAGGAGGTACTGGACGGCATTTAGGTAGTAGCCACAAAATTTGTTGGACATTCTAATTCTGTAATTCGATCAGCTTACGGTGCATCATATATACAAACAGTTCGGAAACGGCGGCTAGGT AGGAGCTCACAGCGCTTCAAGACCCCACCATCGTTGTTGAGGTCCCCTAGCCGGACCCCAGTCTGGGGCTTCAGGCAGCGCATGCGAAGAGTTCCGCATGTGTCTATAAGTATGCGATGAGTTAGAACGGTCCGTGAACCAGGCCCTTTGTTTGATATTCGCGCTTTCCCGTCCACGTAATACCCAACCCCTACACGCTGGCAGTAGCCGGTGTATTACGGGAGGTCTATTCTGCCGTTAAAACCTAGCTGAGAGAGAGCAGTGATGAACAGATTCGCACCATTCACTTACATTTATTAGTTTGCGTACGTGGCGCCTTCGAAGGTAGCCTT AGAGGGGACTATACGGGTGCTTGGAACATTCAGGCGCGGCAGCGTATTGACTTCTACCGAAATCGAAAATCGGTATTCGAAAGACAGATCTTCTGTTGACCTAATTTCGTTCCTGTATGCTGCGAACTCACGATTGCACCAAATGGCACTTACATAGCTACACAGGGCCGAAAGTCTGCGCGAACCGGTCTGTAGATGAAACGGCCAATCTCGCTCACTTAGAGTGGCCTGGGGCACCGGTGACTTCGCTAGGATCCAAGGAACACACGCTTATCATTAAGTGTGCCAACGCACCAATGGTGGTTTTTCATTGCGGTGTTACTCCATTGATA TTGATCTGAGGGCTGGTCCCTTACACGATGATACGGGTCTTCGATACGTCGCCCAGTGCGAGTCGTTCGGCGAATAACAGTAGGACAGCCGATTAATCGGTGACTATCTTTGTCAATAGTCCCAACTCCTACACGCCAAGCGGTAATTTGGCTCAACTATTGCGAAACACATCTTACTATCCGGCGGTAACCTTTACAAGATATTTGCAAAGTAATAGGCTGTTCTGACAGTGTAAGCGATCGACTTCCAGTGAAGATCGCAAGGTAAACCTGTAGCCATGGCATTGGCGCTGCGTCAAAGCTGCGTGGAAGCTTCTCCAATGCCATGCCTG CGCGCTTTAGAATCTCTTTCGCATCAGAGCGGTCTTACGTTCAAGACAAGTGAACACTATTGTTCGAGCCTATGAACATTCACTAAGCTCCTAATCTGGTATCCGGACATCCGTCGGAGTGGGGAGGTCACAGAGGCACCAGTTGGGGGATACTAAGACCAGTCCCAAGTGGCGACCTGATATCGACTTAGACACTGGCATCAGGTATGAGTATAACGAGAATGCCACTAATCAATGAACTGGAAAGTGAAGGGCTACACGAGTGAAATCATCTGCTCAGTAGGCTTCTGTAGGCAAGCGCCACGTAAACCATCGAGACCAAGTGGACCCGG GACGATATGCCAATACGATGACATAGATGGCCACGGGCAGCTAGGATCGAGACTATTGTGTGTCGAAACGCCCCAATCATGTTTGATGGGTCGATTTCTGGTCGCTAGGCTACCCACATTTCGCCGGTTAGCAGCCACTAAGTAGAGGCTCCGTCTCATCAAGCCTCACATTATTTGGAAACGTCATAGACTGTATCTTTCTCTAGATGCCTCGGGCGAGCATCGGGGTACACGAATCGACGGCGATCAACTAGGGAACGAACATATTTCATGGCGTTGGCCACTGGCTGACTTCTGCTCTTTATTTGGCCAAGGGCTACAGCGAACTAGTG TGGATGCGTGAAAGTTTAGCTCCAACACTGTCGGCCTGATCTATTCTTTTACATAACCGAACTCACGGAGTAACCGGCTTGGTGGCCGATTAGCTTCTATTACACTCCCGGTGGGCCGACGACTATACTGCATCTACGAGGAGCCGAAGTAGTTAGTCATTTGTCAGGCGCTAACTTGCGCTTGCTTAGTATGGCAGGCTTCTACTTGAGAGTGCTCTCACCTAGTGTACGCGTAATTGTCCGTTCTCGGGTTTGTATCGCTATTACGCAGTCGATTCTCTACAAGGTAGCCATAACGGACCCCTGCGATCGACCAAGGGCTACTGCCTTAA CGTCAGATGAGAATTGTGGATCGTCAAGTTCAGTACCCTGGCGGTATGATTTAGTGGATTACAATCCCCAAGTTATACACGCCCCTCTTGGCAAGGGGGAGTCCCAGCGTCCGACGGCTTACCGTTGTACCATGTCGCAACATCCCATGACTAGATTCGTGTGCGATTGTCTCGACGATTGCGATCTCCCTAGCGGACTTTCAGCAGCCAATACAAATGTAGCAAACACTTAAAGTTGGAATAGCATGGCAAAAAACTAATGCGGTGGTGATTTAGTTGAATGATTGGAGCTCGTTTATTTGTGTGACCAGCCCCTTGATTGCATCGCCTTT CGAATGATACCTCCAACATGAGGGGCGTACTCATAACGTAAGATTAGATCGCCCGAACCTGATCTTTTTTCCTCAATTTCCAGGTGAGTATAAGAGTCCCCCCTCCACCCGGCGTTGAGTGGGTACACTGAGGCTCTGAGTCTGTAGATGTTGAACGTTAATACCGTGCGTGATTCACGGTAAACGTAGTGAATTCCGCAGAGAGCGGGAGGAACGCCAGCATGGCCATCAGGCCGAGCCCTGTTCTCGTGATCTTACCAATGGTATACCAAGGGCCGTACGCCCCCCATAATCCCTACTGATCAGTGCGTCAAAGTTTAGCCCAAATTGTG CTCCGGTTTTATGGTGGGGCGACTGTTCAACAGAATCGCAGCTTTTAAATACGACACTAAGCAGGGAACCACCATATCGGAATAGTGGTGCGGCGTACGATACACCTATAGTAGTTGCCGATCAGTTGCTTATCTCTCTTGGGGCTACACGCCTCCCAACTAAAAAGAAGCGTGCCATCCCCCAGAAACCCCATTTGGTTACTATCAGTAGGGTTATCAATATCACAGATGTTGAGTCAGGCGCGATGACCGGTGTGGCCCTAATCAGTACCGTAGTCGAGCGCTTGGACACGAATTTTTAGGCCGCCCCGGTATTGAGTGAGGATGCAAGG GCATGACACGAAGCTTCTCTCCTTACTTATCATCATCGGAATTTGTCAGAGTAAAGAGGCGCTCACGTACTACCCTAAGCAGGCCTACGAAGTGGTCGAGTAAAGCGTACTAAAACCCGATTCCCCAACCGCTGCCAAAGCACTCGAGTGTTACATGGCGGAAATATCAAATGCATAATCGATGGATGTAAGTGTCGGTTCTAGGAAGTCCACTCTTTGCCCACCTGCTACACGCCGACCCCAGGACTTCCTCTAATTTCTCAGTTTACTGGAATTTTTCACCGCATCAATACATGAAAGGCCGAGGGTGCCCTTAGATCCGTATCTGTCTA
    GGTAGTGTTACACGC
    GGTAGTGTTACACGC
    CCTGAGGCTACACGC
    CCAAGGGGGGCACGC
    CCAAGGGCTCTCCGC
    CCAAGGGCTATCAGC
    CCAAGGTGGACACGC
    TATAGGGCTACACGC
    GCAAGGGCTACACCT
    CCAAGACGTACACGC
    CCAACCCCTACACGC
    CCAAGGAACACACGC
    CCAACTCCTACACGC
    TGAAGGGCTACACGA
    CCAAGGGCTACAGCG
    CCAAGGGCTACTGCC
    CCAAGTTATACACGC
    CCAAGGGCCGTACGC
    CTTGGGGCTACACGC
    CCACCTGCTACACGC
    64



```python

```
